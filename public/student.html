<html>

<head>

</head>

<body>

















    <!-- scripts! -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <script>
        var camConnection = new RTCPeerConnection({
            iceServers: [{
                urls: "stun:stun.1.google.com:19302"
            }]
        });
        var screenConnection = new RTCPeerConnection({
            iceServers: [{
                urls: "stun:stun.1.google.com:19302"
            }]
        })

        function loadStudent() {
            var webCam = navigator.getUserMedia({
                video: true,
                audio: true
            }, function(stream) {
                camConnection.addStream(stream)
            }, function(err) {
                console.log(err)
            })
            var screenShare = navigator.mediaDevices.getDisplayMedia({
                video: true,
                audio: true
            }).then(function(stream) {
                screenConnection.addStream(stream);
            })

        }

        function loadRoom(room) {
            $.post("/ss/getroom", {
                room: room
            }, function(proctorKey) {
                console.log(proctorKey);
                camConnection.setRemoteDescription({
                    type: "offer",
                    sdp: proctorKey
                }).then(function() {
                    camConnection.createAnswer()
                }).then(function(mine) {
                    camConnection.setLocalDescription(mine);
                })
            }).then(function() {
                camConnection.onicecandidate = function() {

                    $.post("/ss/joinroom", {
                        key: camConnection.localDescription.sdp,
                        room: room
                    }, function(data) {

                    })

                }
            })

            //SCREEN CONNECTION TIMEðŸ˜€
            // $.post("/ss/getroom", {
            //     room: room
            // }, function(proctorKey) {
            //     console.log(proctorKey);
            //     screenConnection.setRemoteDescription({
            //         type: "offer",
            //         sdp: proctorKey
            //     }).then(function() {
            //         screenConnection.createAnswer()
            //     }).then(function(mine) {
            //         screenConnection.setLocalDescription(mine);
            //     })
            // }).then(function() {
            //     screenConnection.onicecandidate = function() {

            //         $.post("/ss/joinroom", {
            //             key: screenConnection.localDescription.sdp,
            //             room: room
            //         }, function(data) {

            //         })

            //     }
            // })








        }
    </script>
</body>




</html>